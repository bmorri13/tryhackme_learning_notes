# Authentication
- Write ups to include lessons learned and some answers for what the THM labs involve

## Session Management - Write Up

### What is Session Management?

#### Session Management Lifecycle
- **Session Creation** - most cases this begins when you access the site before you authenticate, however in this class it will look at authenticated sessions
- **Session Tracking** - Once you access / authenticate, the web app will track actions through the HTTP protocl in s stateless nature. (e.g. each GET, POST, UPDATE, etc. is all tracked)
- **Session Expiry** - Each session should have an experation placed upon it and then force you to go through the session management lifecycle again. If not, this could allow for a long timeframe auth'ed session that can be hijacked
- **Session Termination** - In some cases the web app will force a logout action (e.g. banking apps or investment platforms). This should force a Session experation. However, it is unqiue in the process since the session is still valid which can cause issues in the terminaition process where a threat actor cloud gain persistan access to an account if not done properly


### Authentication vs Authorisation
- **Identification** - Used to identify a user as they claim a spefici identity (e.g. When you login with your username). You claim that you are the user asscoated with the sepfic user. Some apps require unieuely create usernames where they will take your email address as your username (e.g. Logging into social sites with an email address requires it to be unique)
- **Authentication** - Process of ensuraing the user is whot hey sayd they are, you provide a username for auth and then also a password for that username (e.g. using auth modules to validate you are your account). This is the point wehre a session creation would begin
- **Authorisation** - Process of ensuring the sepfici user has ther ights reuqirewd to perform actions, E.g. while all users can vie data, only a seelct few can modify. Think an admin account, read only, Power User, etc.
- **Accountability** - Creates a record of the actions perfomed by users. Would track the users session and log all actions performed for thier specific session. Plays a critical role int he event of a security incidnet to peice togeather what happens 
- **IAAA and Session Management** - Auth plays a key role in provdieing how sessions are created. Authorisation verifies the assocated user with a specif session has eprmissions. Accountability is crucial to peice togeahter what actually occured if there is an incident to review logs.

### Cookies vs Tokens

#### Cookie-Based Session Management
- Uses Set-Cookie header value to mange the session and tracking purposes
- Key thing to remember with cookie-based authentication is that the browser itself will decide when a certain cookie value will be sent with a request

#### Token-Based Session Management
- After authentication, the web application provides a token within the request body. Using client-side JavaScript code, this token is then stored in the browser's LocalStorage
- JavaScript code must load the token from storage and attach it as a header
- Knowas a JWT Token (JSON Web Token)
- Passed through the Authorization: Bearer header


### Benefits and Drawbacks
| Cookie-Session Management | Token-Based Session Management|
|---------------------------|-------------------------------|
| Cookie is automatically sent by the browser with each request | Token has to be submitted as a header with each request using client-side JavaScript |
| Cookie attributes can be used to enhance the browser's protection of the cookie | Tokens do not have automatic security protections enforced and should, therefore, be safeguarded against disclosures
|Cookies can be vulnerable to conventional client-side attacks such as CSRF, where the browser is tricked into making a request on behalf of the user.| As the token is not automatically added to any request and cannot be read from LocalStorage by other domains, conventional client-side attacks such as CSRF are blocked. |
| As cookies are locked to a specific domain, it can be difficult to use them securely in decentralised web applications.| Tokens work well in decentralised web applications, as they are managed through JavaScript and can often contain all the information required to verify the token itself.|

### Exploiting Insecure Session Management
- Tested out modifuing the cooke in Local Storage of the session we logged into
- We were able to change our userRole from `student` to `teacher` and see the full list of students, tests, taking, etc.
 